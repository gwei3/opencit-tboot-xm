
c=$(cat /proc/cmdline)
c="${c##*sr_lvm_device=}"
sr_lvm_device="${c%% *}"

if [ -z "$sr_lvm_device" ]; then
    echo "sr_lvm_deviceis not provided in kernel arguments"
    exit 1
fi

echo "Open parition for SR. Use: /dev/mapper/crypt-sr for xe sr-create command"
cryptsetup -c aes-xts-plain64 luksOpen --key-file=/bootpartition/$lvm_enc_key  $sr_lvm_device crypt-sr

